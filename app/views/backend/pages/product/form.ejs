<%- include('./../../helpers/showCategoryForm'); -%>
<%- include('./../../helpers/showoptionbox'); -%>
<%- include('./../../helpers/showthumbmulti'); -%>
<%- include('./../../helpers/showerror'); -%>

<% 
	const collection = "product";
	const linkPrefix = "/" + systemConfig.prefixAdmin + `/${collection}/`;
	const linkThumb = "/" + "uploads" + `/${collection}/`;
%>

<%- showError(main.showError) %>
<div class="card card-info card-outline">
    <form action="<%= linkPrefix %>save/<%= item.id %>" method="POST" class="mb-0" enctype="multipart/form-data">
        <div class="card-body">
            <%= main.pageTitle %>
            <div class="form-group row">
                <label for="name" class="col-sm-2 col-form-label text-sm-right required">Name</label>
                <div class="col-xs-12 col-sm-8">
                    <input type="text" id="name-input-form" name="name" value="<%= item.name %>" class="form-control form-control-sm"></div>
                </div>
                <div class="form-group row">
                    <label for="price"  class="col-sm-2 col-form-label text-sm-right required">Price</label>
                    <div class="col-xs-12 col-sm-8">
                        <input type="number" id="price-input-form" name="price" value="<%= item.price %>" min="1" class="form-control form-control-sm"></div>
                </div>
                <div class="form-group row">
                    <label for="stock"  class="col-sm-2 col-form-label text-sm-right required">Stock</label>
                    <div class="col-xs-12 col-sm-8">
                        <input type="number" id="stock-input-form" name="stock" value="<%= item.stock %>" min="0" class="form-control form-control-sm"></div>
                </div>
                <div class="form-group row">
                    <label for="description"  class="col-sm-2 col-form-label text-sm-right required">Description</label>
                    <div class="col-xs-12 col-sm-8">
                        <input type="text" id="description-input-form" name="description" value="<%= item.description %>" class="form-control form-control-sm"></div>
                    </div>
                <div class="form-group row">
                    <label for="categoryId" class="col-sm-2 col-form-label text-sm-right required">Category</label>
                    <div class="col-xs-12 col-sm-8">
                        <select name="categoryId" id="input-category" class="form-control form-control-sm">
                            <%- showCategoryList(main.categoryList, item.category) %>
                        </select>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="name" class="col-sm-2 col-form-label text-sm-right required">Slug</label>
                    <div class="col-xs-12 col-sm-8">
                        <input type="text" name="slug" id="slug-input-form" value="<%= item.slug %>" class="form-control form-control-sm"></div>
                    </div>
                    <div class="form-group row">
                        <label for="name" class="col-sm-2 col-form-label text-sm-right required">Ordering</label>
                        <div class="col-xs-12 col-sm-8">
                            <input type="number" min="1" name="ordering" value="<%= item.ordering %>" class="form-control form-control-sm"></div>
                        </div>
                            <div class="form-group row">
                                <label for="status" class="col-sm-2 col-form-label text-sm-right">Status</label>
                                <div class="col-xs-12 col-sm-8">
                                    <select id="status" name="status" class="custom-select custom-select-sm">
                                        <option value="novalue">Choose Status</option>
                                        <option value="active" <%= (item.status == "active") ? 'selected="selected"' : '' %>>
                                            Active</option>
                                        <option value="inactive" <%= (item.status == "inactive") ? 'selected="selected"' : '' %>>
                                            Inactive</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="option" class="col-sm-2 col-form-label text-sm-right required">Option</label>
                                <div class="col-xs-12 col-sm-8">
                                    <div class="custom-control custom-checkbox">
                                        <input class="custom-control-input" type="checkbox" name="dailydeals" id="dailydeals" value="true" <%= (item.dailydeals == true) ? 'checked' : '' %> >
                                        <label for="dailydeals" class="custom-control-label">Show Daily Deals</label>
                                        </div>
                                    <div class="custom-control custom-checkbox">
                                        <input class="custom-control-input" type="checkbox" name="fearturedproduct" id="fearturedproduct" value="true" <%= (item.fearturedproduct == true) ? 'checked' : '' %> >
                                        <label for="fearturedproduct" class="custom-control-label">Show Feartured Product</label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group row uploadImage">
                                <label for="thumb" class="col-sm-2 col-form-label text-sm-right ">Upload Images</label>
                                <div class="col-xs-12 col-sm-8">
									<input id="ImageMediasProduct" name="thumb" type="file" class="custom-file-input" value="Product" multiple>
									<div id="imageMediaPreviewProduct">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group row ckeditor">
                                <label for="uploaded" class="col-sm-2 col-form-label text-sm-right">Image Uploaded</label>
                                <div class="col-xs-12 col-sm-8">
                            <% if (item.thumb != undefined) { %>
                                <%- showThumbMulti(item.id, item.thumb, linkThumb) %>
                            <%}  %>
                                </div>
                            </div>
                            <div class="form-group row ckeditor">
                                <label for="detail" class="col-sm-2 col-form-label text-sm-right">Detail Product</label>
                                <textarea id="summernote" name="detail">
                                </textarea>
                            </div>

                        </div>
                        <div class="card-footer">
                            <div class="col-12 col-sm-8 offset-sm-2">
                                <input class="form-control" name="id" value="" type="hidden">
                                <input name="image_old" value="<%= item.thumb%>" type="hidden">
				                <input name="image_uploaded" value="" type="hidden" id="image_uploaded">
                                <input name="image_delete" value="" type="hidden" id="image_delete">
                                    <button type="submit" class="btn btn-sm btn-success mr-1">
                                        Submit</button>
                                    <a href="<%= linkPrefix %>" class="btn btn-sm btn-danger mr-1">
                                        Cancel</a>
                                </div>
                            </div>
                        </form>
</div>

 <script src="/plugins/jquery/jquery.min.js"></script>
 <!-- jQuery UI 1.11.4 -->
<script src="/plugins/jquery-ui/jquery-ui.min.js"></script> 
<!-- Summernote -->
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>        
<script>
        var editorData = `<%- item.detail %>`;
        $('#summernote').summernote('code', editorData);
        ImageMediasProduct.onchange = evt => {
			const [file] = ImageMediasProduct.files
			if (file) {
				image_uploaded.setAttribute('value','uploaded')
			} else{
                image_uploaded.setAttribute('value','')
            }
		}
        deletePhoto = (img) =>{
            if (confirm("Are you sure detele this photo?")) {
                    let data = $('#image_delete').val() + ',' + $(`#img-${img}`).attr('data-name')
                    console.log(data)
                    $('#image_delete').val(data)
                    $(`#img-${img}`).remove()
                return true;
            } else {
                return false;
            }
        }
</script>


